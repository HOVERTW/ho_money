# ğŸ’± åŒ¯ç‡æª”æ¡ˆæ¸…ç†å®Œæˆ

## ğŸ“Š æ¸…ç†æ‘˜è¦

### å·²åˆªé™¤çš„èˆŠç‰ˆæœ¬åŒ¯ç‡æª”æ¡ˆ
```
âŒ scripts/fetch-exchange-rates.js (èˆŠç‰ˆæœ¬ï¼Œä½¿ç”¨ä¸åŒAPI)
âŒ database/exchange_rate_setup.sql (èˆŠè³‡æ–™è¡¨çµæ§‹)
âŒ database/fix_exchange_rate_29925.sql (èˆŠä¿®æ­£æª”æ¡ˆ)
âŒ database/fix_latest_exchange_rate.sql (èˆŠä¿®æ­£æª”æ¡ˆ)
âŒ database/update_correct_exchange_rates.sql (èˆŠæ›´æ–°æª”æ¡ˆ)
```

### ä¿ç•™çš„æ­£ç¢ºç‰ˆæœ¬
```
âœ… scripts/update-exchange-rates.js (å”¯ä¸€æ­£ç¢ºç‰ˆæœ¬)
âœ… .github/workflows/update-stocks.yml (å·¥ä½œæµç¨‹æŒ‡å‘æ­£ç¢ºæª”æ¡ˆ)
```

## ğŸ” ç‰ˆæœ¬å·®ç•°åˆ†æ

### èˆŠç‰ˆæœ¬å•é¡Œ (å·²åˆªé™¤)
```javascript
// scripts/fetch-exchange-rates.js (èˆŠç‰ˆæœ¬)
âŒ ä½¿ç”¨ä¸åŒçš„ API ç«¯é»
âŒ ä¸åŒçš„è³‡æ–™è¡¨çµæ§‹
âŒ ç¼ºå°‘éŒ¯èª¤è™•ç†
âŒ æ²’æœ‰å‚™ç”¨ API
âŒ è³‡æ–™æ ¼å¼ä¸ä¸€è‡´
```

### æ­£ç¢ºç‰ˆæœ¬ç‰¹é» âœ…
```javascript
// scripts/update-exchange-rates.js (ä¿ç•™ç‰ˆæœ¬)
âœ… ExchangeRate-API ä¸»è¦ä¾†æº
âœ… å°ç£éŠ€è¡Œ API å‚™ç”¨
âœ… é è¨­å€¼ä¿éšœæ©Ÿåˆ¶
âœ… æ­£ç¢ºçš„è³‡æ–™è¡¨æ¬„ä½ (spot_buy, spot_sell)
âœ… å®Œæ•´çš„éŒ¯èª¤è™•ç†
âœ… è©³ç´°çš„åŸ·è¡Œæ—¥èªŒ
âœ… å¯¦éš›å¯«å…¥ Supabase
```

## ğŸ§ª æœ¬åœ°æ¸¬è©¦çµæœ

### åŸ·è¡Œæ¸¬è©¦
```bash
npm run update:rates
```

### æ¸¬è©¦çµæœ âœ… æˆåŠŸ
```
ğŸ’± GitHub Actions - åŒ¯ç‡æ›´æ–°é–‹å§‹
â° åŸ·è¡Œæ™‚é–“: 2025/6/6 ä¸‹åˆ12:58:48
ğŸš€ é–‹å§‹æ›´æ–°åŒ¯ç‡...
ğŸ”„ å¾ ExchangeRate-API ç²å– USD/TWD åŒ¯ç‡...
âœ… æˆåŠŸç²å– ExchangeRate-API åŒ¯ç‡

ğŸ“Š åŒ¯ç‡æ›´æ–°çµæœ:
==================
ğŸ’° USD/TWD: 29.87                    âœ… æ­£ç¢ºåŒ¯ç‡
ğŸ’µ è²·å…¥åƒ¹ (spot_buy): 29.8103        âœ… åˆç†åƒ¹å·®
ğŸ’µ è³£å‡ºåƒ¹ (spot_sell): 29.9297       âœ… åˆç†åƒ¹å·®
ğŸ“… æ—¥æœŸ: 2025-06-06                  âœ… æ­£ç¢ºæ—¥æœŸ
ğŸ”„ ä¾†æº: ExchangeRate-API            âœ… ä¸»è¦API
â° æ›´æ–°æ™‚é–“: 2025-06-06T04:58:48.935Z âœ… æ­£ç¢ºæ™‚é–“

âš ï¸ Supabase ç’°å¢ƒè®Šæ•¸æœªè¨­ç½®ï¼Œè·³éè³‡æ–™åº«æ›´æ–°  âœ… æ­£å¸¸ï¼ˆæœ¬åœ°æ¸¬è©¦ï¼‰
ğŸ’¡ åŒ¯ç‡åŠŸèƒ½æ­£å¸¸é‹è¡Œ                   âœ… è…³æœ¬æ­£å¸¸
```

## ğŸ“‹ GitHub Actions å·¥ä½œæµç¨‹ç¢ºèª

### å·¥ä½œæµç¨‹æª”æ¡ˆ âœ… æ­£ç¢º
```yaml
# .github/workflows/update-stocks.yml
- name: æ›´æ–°åŒ¯ç‡
  if: github.event.inputs.update_type == 'rates'
  run: node scripts/update-exchange-rates.js  # âœ… æŒ‡å‘æ­£ç¢ºæª”æ¡ˆ
```

### åŸ·è¡Œæ–¹å¼
```
é¸æ“‡: ğŸ“ˆ è‚¡ç¥¨è³‡æ–™æ›´æ–°
é¸é …: rates (åŒ¯ç‡æ›´æ–°)
åŸ·è¡Œ: Run workflow
```

## ğŸ¯ é æœŸ GitHub Actions çµæœ

### æˆåŠŸåŸ·è¡Œæœƒé¡¯ç¤º
```
ğŸ’± GitHub Actions - åŒ¯ç‡æ›´æ–°é–‹å§‹
â° åŸ·è¡Œæ™‚é–“: [æ™‚é–“]
ğŸš€ é–‹å§‹æ›´æ–°åŒ¯ç‡...
ğŸ”„ å¾ ExchangeRate-API ç²å– USD/TWD åŒ¯ç‡...
âœ… æˆåŠŸç²å– ExchangeRate-API åŒ¯ç‡

ğŸ“Š åŒ¯ç‡æ›´æ–°çµæœ:
==================
ğŸ’° USD/TWD: [ç•¶å‰åŒ¯ç‡]
ğŸ’µ è²·å…¥åƒ¹ (spot_buy): [è²·å…¥åƒ¹]
ğŸ’µ è³£å‡ºåƒ¹ (spot_sell): [è³£å‡ºåƒ¹]
ğŸ“… æ—¥æœŸ: 2025-06-06
ğŸ”„ ä¾†æº: ExchangeRate-API
â° æ›´æ–°æ™‚é–“: [æ™‚é–“]

ğŸ’¾ é–‹å§‹æ›´æ–°åˆ° Supabase...
ğŸ“ æº–å‚™å¯«å…¥çš„è³‡æ–™: [JSONè³‡æ–™]
ğŸ—‘ï¸ å·²æ¸…é™¤ä»Šå¤©çš„èˆŠåŒ¯ç‡è³‡æ–™
âœ… åŒ¯ç‡å·²æˆåŠŸæ›´æ–°åˆ° Supabase
ğŸ’¾ æ›´æ–°çš„è³‡æ–™: [æ›´æ–°çµæœ]

ğŸ‰ åŒ¯ç‡æ›´æ–°å®Œæˆï¼è³‡æ–™å·²ä¿å­˜åˆ° Supabase
ğŸ’¡ åŒ¯ç‡åŠŸèƒ½æ­£å¸¸é‹è¡Œ
```

### Supabase è³‡æ–™æª¢æŸ¥
```sql
SELECT * FROM exchange_rates 
WHERE rate_date = CURRENT_DATE 
  AND base_currency = 'USD' 
  AND target_currency = 'TWD';
```

**é æœŸçµæœ**ï¼š
- âœ… base_currency: 'USD'
- âœ… target_currency: 'TWD'
- âœ… rate: [ç•¶å‰åŒ¯ç‡]
- âœ… spot_buy: [è²·å…¥åƒ¹] (ç•¥ä½æ–¼åŒ¯ç‡)
- âœ… spot_sell: [è³£å‡ºåƒ¹] (ç•¥é«˜æ–¼åŒ¯ç‡)
- âœ… source: 'ExchangeRate-API'
- âœ… rate_date: '2025-06-06'
- âœ… updated_at: [æ›´æ–°æ™‚é–“]

## ğŸš€ ç«‹å³æ¨é€æ¸…ç†çµæœ

### æ­¥é©Ÿ 1ï¼šæ¨é€æ¸…ç†å¾Œçš„æª”æ¡ˆ
```bash
git add .
git commit -m "æ¸…ç†åŒ¯ç‡æª”æ¡ˆ - ç§»é™¤èˆŠç‰ˆæœ¬ï¼Œä¿ç•™å”¯ä¸€æ­£ç¢ºç‰ˆæœ¬"
git push origin main
```

### æ­¥é©Ÿ 2ï¼šåŸ·è¡Œ GitHub Actions æ¸¬è©¦
1. **å‰å¾€ GitHub Actions**ï¼š
   ```
   https://github.com/HOVERTW/FinTranzo/actions
   ```

2. **åŸ·è¡ŒåŒ¯ç‡æ›´æ–°**ï¼š
   - é¸æ“‡ `ğŸ“ˆ è‚¡ç¥¨è³‡æ–™æ›´æ–°`
   - é¸æ“‡ `rates` (åŒ¯ç‡æ›´æ–°)
   - é»æ“Š `Run workflow`

3. **æª¢æŸ¥åŸ·è¡Œçµæœ**ï¼š
   - âœ… ç„¡èªæ³•éŒ¯èª¤
   - âœ… æˆåŠŸç²å–åŒ¯ç‡
   - âœ… æˆåŠŸå¯«å…¥ Supabase
   - âœ… æ­£ç¢ºçš„è³‡æ–™æ ¼å¼

## ğŸ’¡ é‡è¦æ”¹é€²

### 1. æª”æ¡ˆçµæ§‹æ¸…ç†
**æ¸…ç†å‰**ï¼š
- âŒ å¤šå€‹åŒ¯ç‡æª”æ¡ˆé€ æˆæ··æ·†
- âŒ ä¸åŒç‰ˆæœ¬ä½¿ç”¨ä¸åŒ API
- âŒ è³‡æ–™è¡¨çµæ§‹ä¸ä¸€è‡´

**æ¸…ç†å¾Œ**ï¼š
- âœ… åªæœ‰ä¸€å€‹æ­£ç¢ºçš„åŒ¯ç‡æª”æ¡ˆ
- âœ… çµ±ä¸€çš„ API å’Œè³‡æ–™çµæ§‹
- âœ… ç‰ˆæœ¬æ¸…æ™°ï¼Œç„¡é‡è¤‡

### 2. API æ”¹é€²
**èˆŠç‰ˆæœ¬**ï¼š
- âŒ å–®ä¸€ API ä¾†æº
- âŒ ç„¡å‚™ç”¨æ©Ÿåˆ¶
- âŒ éŒ¯èª¤è™•ç†ä¸å®Œæ•´

**æ–°ç‰ˆæœ¬**ï¼š
- âœ… ä¸»è¦ï¼šExchangeRate-API
- âœ… å‚™ç”¨ï¼šå°ç£éŠ€è¡Œ API
- âœ… ä¿éšœï¼šé è¨­å€¼æ©Ÿåˆ¶
- âœ… å®Œæ•´éŒ¯èª¤è™•ç†

### 3. è³‡æ–™è¡¨ä¸€è‡´æ€§
**ç¢ºä¿ä½¿ç”¨æ­£ç¢ºæ¬„ä½**ï¼š
- âœ… spot_buy (è²·å…¥åƒ¹)
- âœ… spot_sell (è³£å‡ºåƒ¹)
- âœ… rate_date (åŒ¯ç‡æ—¥æœŸ)
- âœ… updated_at (æ›´æ–°æ™‚é–“)

## ğŸ“Š æ¸…ç†å‰å¾Œå°æ¯”

### æ¸…ç†å‰ï¼ˆå•é¡Œï¼‰
```
âŒ 5 å€‹åŒ¯ç‡ç›¸é—œæª”æ¡ˆ
âŒ ç‰ˆæœ¬æ··äº‚ï¼ŒAPI ä¸ä¸€è‡´
âŒ GitHub Actions å¯èƒ½åŸ·è¡ŒéŒ¯èª¤ç‰ˆæœ¬
âŒ è³‡æ–™è¡¨çµæ§‹ä¸çµ±ä¸€
```

### æ¸…ç†å¾Œï¼ˆæ”¹é€²ï¼‰
```
âœ… 1 å€‹æ­£ç¢ºçš„åŒ¯ç‡æª”æ¡ˆ
âœ… ç‰ˆæœ¬æ¸…æ™°ï¼ŒAPI çµ±ä¸€
âœ… GitHub Actions åŸ·è¡Œæ­£ç¢ºç‰ˆæœ¬
âœ… è³‡æ–™è¡¨çµæ§‹ä¸€è‡´
```

---

**åŒ¯ç‡æª”æ¡ˆæ¸…ç†å®Œæˆï¼** ç¾åœ¨è«‹æ¨é€æ›´æ”¹ä¸¦æ¸¬è©¦ GitHub Actions åŒ¯ç‡æ›´æ–°åŠŸèƒ½ã€‚é€™æ¬¡æ‡‰è©²æœƒåŸ·è¡Œæ­£ç¢ºçš„ç‰ˆæœ¬ä¸¦æˆåŠŸå¯«å…¥ Supabaseï¼
